#!/bin/bash
# ~/.config/eww/scripts/tags
# возвращает JSON массив тегов для mango
# формат: [{"id": 1, "active": true, "occupied": false, "monitor": "0"}, ...]

ACTIVE_TAG=$(mmsg -g 2>/dev/null | grep -oP '"current_tag":\s*\K[0-9]+' || echo "1")

# получаем список занятых тегов (если mmsg поддерживает)
# пока просто генерируем 1-9

echo -n "["
for i in $(seq 1 9); do
  if [ $i -eq $ACTIVE_TAG ]; then
    ACTIVE="true"
  else
    ACTIVE="false"
  fi

  echo -n "{\"id\":$i,\"active\":$ACTIVE,\"occupied\":false}"

  if [ $i -lt 9 ]; then
    echo -n ","
  fi
done
echo "]"
