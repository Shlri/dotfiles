#!/bin/bash
# ~/.config/eww/scripts/battery
# возвращает JSON: {"level": 85, "status": "Charging"}

BAT=$(ls /sys/class/power_supply/ 2>/dev/null | grep -i bat | head -n1)

if [ -z "$BAT" ]; then
  echo '{"level":100,"status":"Full"}'
  exit 0
fi

LEVEL=$(cat "/sys/class/power_supply/$BAT/capacity" 2>/dev/null || echo "100")
STATUS=$(cat "/sys/class/power_supply/$BAT/status" 2>/dev/null || echo "Full")

echo "{\"level\":$LEVEL,\"status\":\"$STATUS\"}"
