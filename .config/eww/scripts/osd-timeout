#!/bin/bash
# ~/.config/eww/scripts/osd-timeout
# аргумент $1 = "volume" или "brightness"
# открывает OSD, ждёт 2 сек, закрывает
# если OSD уже открыт — просто обновляет таймер (убивает старый процесс)

TYPE="$1"
LOCK="/tmp/eww-osd-lock"

# убиваем старый таймер если есть
if [ -f "$LOCK" ]; then
  kill "$(cat "$LOCK")" 2>/dev/null
fi

# ставим тип и открываем
eww update osd-type="$TYPE"
eww open osd

# запускаем таймер в фоне
(
  sleep 2
  eww close osd
  eww update osd-type=""
) &

# сохраняем PID таймера
echo $! > "$LOCK"
